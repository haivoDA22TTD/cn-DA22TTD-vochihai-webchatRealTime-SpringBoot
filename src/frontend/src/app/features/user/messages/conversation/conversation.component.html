<div class="conversation" style="font-weight: normal;"
  [class.selected]="selectedMessageRoomId === room.id"
  [class.unseen]="room.unseenCount && room.unseenCount > 0">

  <ng-container *ngIf="!room.isGroup">
    <ng-container *ngFor="let member of room.members">
      <app-avatar *ngIf="member.username !== currentUser.username"
        [username]="member.username"
        [avatarUrl]="member.avatarUrl"
        [width]="'44px'">
      </app-avatar>
    </ng-container>
  </ng-container>

  <div *ngIf="room.isGroup" class="group-avatar-container">
    <div class="group-avatar-stack">
      <ng-container *ngFor="let member of room.members?.slice(0, 3); let i = index">
        <div class="group-avatar-item" [style.z-index]="3 - i" [style.margin-left]="i > 0 ? '-12px' : '0'">
          <app-avatar
            [username]="member.username"
            [avatarUrl]="member.avatarUrl"
            [width]="'28px'">
          </app-avatar>
        </div>
      </ng-container>
      <div *ngIf="room.members && room.members.length > 3" class="group-avatar-more">
        +{{room.members.length - 3}}
      </div>
    </div>
    <span class="group-online-indicator" *ngIf="userService.getRoomStatus(room) === 'Online'"></span>
  </div>
  
  <div class="conversation-detail">
    <div class="conversation-username">{{room | messageRoomName}}</div>
    <div class="conversation-content">
      <span>
        <ng-container *ngIf="room.lastMessage?.messageType === 'IMAGE'">
          ğŸ“· ÄÃ£ gá»­i má»™t áº£nh
        </ng-container>
        <ng-container *ngIf="room.lastMessage?.messageType === 'LOCATION'">
          ğŸ“ ÄÃ£ chia sáº» vá»‹ trÃ­
        </ng-container>
        <ng-container *ngIf="room.lastMessage?.messageType === 'FILE'">
          ğŸ“ ÄÃ£ gá»­i má»™t file
        </ng-container>
        <ng-container *ngIf="room.lastMessage?.messageType === 'LINK'">
          ğŸ”— ÄÃ£ gá»­i má»™t liÃªn káº¿t
        </ng-container>
        <ng-container *ngIf="room.lastMessage?.messageType === 'TEXT'">
          {{room.lastMessage?.content}}
        </ng-container>
      </span>
      <span class="conversation-date">
        <span *ngIf="room.lastMessage?.id">â€¢</span>
        {{room.lastMessage?.dateSent | timeAgo}}
      </span>
    </div>
  </div>
  <div *ngIf="room.unseenCount && room.unseenCount > 0" class="conversation-unseen">
    {{room.unseenCount}}
  </div>
</div>