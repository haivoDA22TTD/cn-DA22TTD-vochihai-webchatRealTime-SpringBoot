<div class="chat-message"
  [class.owner]="messageContent?.sender === currentUser?.username">
  <app-avatar 
    [width]="'40px'"
    [username]="messageContent?.sender">
  </app-avatar>
  <div class="chat-message-content"
    [title]="messageContent?.dateSent | date : 'HH:mm:ss dd/MM/yyyy'">
    <div class="chat-message-username">{{messageContent?.sender}}</div>
    <div class="chat-message-text" *ngIf="messageContent?.messageType === 'TEXT'">
      {{messageContent?.content}}
    </div>
    <div class="chat-message-image" *ngIf="messageContent?.messageType === 'IMAGE'">
      <img [src]="messageContent?.content" 
           alt="Image" 
           (error)="onImageError($event)"
           style="max-width: 300px; max-height: 300px; border-radius: 8px; cursor: pointer;" />
    </div>
    <div class="chat-message-location" *ngIf="messageContent?.messageType === 'LOCATION'">
      <div class="location-preview" (click)="openLocationInMaps()">
        <div class="location-icon">ğŸ“</div>
        <div class="location-info">
          <span class="location-label">Vá»‹ trÃ­ Ä‘Ã£ chia sáº»</span>
          <span class="location-coords">{{getLocationCoords()}}</span>
        </div>
        <div class="location-action">
          <span class="material-symbols-rounded">open_in_new</span>
        </div>
      </div>
      <iframe 
        *ngIf="getMapUrl()"
        [src]="getMapUrl()"
        width="280"
        height="150"
        style="border:0; border-radius: 8px; margin-top: 8px;"
        allowfullscreen=""
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade">
      </iframe>
    </div>
  </div>
</div>